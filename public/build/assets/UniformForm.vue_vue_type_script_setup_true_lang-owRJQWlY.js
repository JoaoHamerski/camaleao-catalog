import{d as E,A as x,T as B,c as I,H as w,a as D,w as l,h as a,J as U,f as s,o as k,g as i,x as j}from"./app-x9s5Mqt1.js";import{u as q}from"./useQuery-xlfzK4mV.js";import{_ as z}from"./UniformFormCategoryOption.vue_vue_type_script_setup_true_lang-Oy0FnGYw.js";const T=E({__name:"UniformForm",props:{uniform:{default:void 0},isEdit:{type:Boolean,default:!1}},setup(p){const r=p,u=x(""),{data:c,isFetching:d,refetch:g}=q({queryKey:["categories"],queryFn:()=>y(),initialData:[]}),o=B({name:"",category:null,images:[]}),f=I(()=>r.isEdit?route("dashboard.uniforms.patch",{uniform:r.uniform.slug}):route("dashboard.uniforms.store")),y=async()=>{const e=route("api.categories.get",{name:u.value});return await fetch(e).then(t=>t.json())},b=e=>{const t=e.target;u.value=t.value,g()},h=e=>e?e.name:"",_=()=>{var e;return{category:((e=o.category)==null?void 0:e.id)||null}},A=async()=>{if(!r.uniform)return;const e=await Promise.all(r.uniform.images.map(async m=>await U(m.url,m.name))),t={name:r.uniform.name,category:r.uniform.category,images:e};Object.assign(o,t)};return w(()=>{r.isEdit&&A()}),(e,t)=>{const m=s("AppInput"),C=s("AppCombobox"),V=s("AppInputFile"),F=s("AppButton"),v=s("AppForm");return k(),D(v,{class:"flex flex-col gap-8",form:a(o),endpoint:f.value,"transformed-data":_,method:e.isEdit?"patch":"post"},{footer:l(()=>[i(F,{loading:a(o).processing,label:e.isEdit?"Atualizar":"Cadastrar",class:j(["btn btn-outline",e.isEdit?"btn-primary":"btn-success"])},null,8,["loading","label","class"])]),default:l(()=>[i(m,{modelValue:a(o).name,"onUpdate:modelValue":t[0]||(t[0]=n=>a(o).name=n),name:"name",label:"Nome",placeholder:"Digite o nome...","error-message":a(o).errors.name,autofocus:""},null,8,["modelValue","error-message"]),i(C,{modelValue:a(o).category,"onUpdate:modelValue":t[1]||(t[1]=n=>a(o).category=n),label:"Categoria",name:"category",placeholder:"Escolha uma categoria...",items:a(c),"display-value":h,loading:a(d),"error-message":a(o).errors.category,onInput:b},{option:l(n=>[i(z,{item:n},null,8,["item"])]),_:1},8,["modelValue","items","loading","error-message"]),i(V,{modelValue:a(o).images,"onUpdate:modelValue":t[2]||(t[2]=n=>a(o).images=n),name:"images.0",label:"Imagens do uniforme",multiple:"",accept:"image/*",hint:"MÃ¡x. 300kB por imagem","error-message":a(o).errors.images||a(o).errors["images.0"]},null,8,["modelValue","error-message"])]),_:1},8,["form","endpoint","method"])}}});export{T as _};
