import{d as E,A as x,T as B,c as I,H as w,a as D,w as l,h as t,J as U,f as s,o as k,g as i,x as j}from"./app-NS2l-4AQ.js";import{u as q}from"./useQuery-J0QlJWWm.js";import{_ as z}from"./UniformFormCategoryOption.vue_vue_type_script_setup_true_lang-V6Ju2X0p.js";const T=E({__name:"UniformForm",props:{uniform:{default:void 0},isEdit:{type:Boolean,default:!1}},setup(p){const r=p,u=x(""),{data:c,isFetching:d,refetch:g}=q({queryKey:["categories"],queryFn:()=>y(),initialData:[]}),o=B({name:void 0,category:void 0,images:void 0}),f=I(()=>r.isEdit?route("dashboard.uniforms.patch",{uniform:r.uniform.slug}):route("dashboard.uniforms.store")),y=async()=>{const e=route("api.categories.get",{name:u.value});return await fetch(e).then(a=>a.json())},b=e=>{const a=e.target;u.value=a.value,g()},h=e=>e?e.name:"",_=()=>{var e;return{category:((e=o.category)==null?void 0:e.id)||null}},A=async()=>{if(!r.uniform)return;const e=await Promise.all(r.uniform.images.map(async m=>await U(m.url,m.name))),a={name:r.uniform.name,category:r.uniform.category,images:e};Object.assign(o,a)};return w(()=>{r.isEdit&&A()}),(e,a)=>{const m=s("AppInput"),C=s("AppCombobox"),V=s("AppInputFile"),v=s("AppButton"),F=s("AppForm");return k(),D(F,{class:"flex flex-col gap-8",form:t(o),endpoint:f.value,"transformed-data":_,method:e.isEdit?"patch":"post"},{footer:l(()=>[i(v,{label:e.isEdit?"Atualizar":"Cadastrar",class:j(["btn btn-outline",e.isEdit?"btn-primary":"btn-success"])},null,8,["label","class"])]),default:l(()=>[i(m,{modelValue:t(o).name,"onUpdate:modelValue":a[0]||(a[0]=n=>t(o).name=n),name:"name",label:"Nome",placeholder:"Digite o nome...","error-message":t(o).errors.name,autofocus:""},null,8,["modelValue","error-message"]),i(C,{modelValue:t(o).category,"onUpdate:modelValue":a[1]||(a[1]=n=>t(o).category=n),label:"Categoria",name:"category",placeholder:"Escolha uma categoria...",items:t(c),"display-value":h,loading:t(d),"error-message":t(o).errors.category,onInput:b},{option:l(n=>[i(z,{item:n},null,8,["item"])]),_:1},8,["modelValue","items","loading","error-message"]),i(V,{modelValue:t(o).images,"onUpdate:modelValue":a[2]||(a[2]=n=>t(o).images=n),name:"images",label:"Imagens do uniforme",multiple:"",accept:"image/*",hint:"MÃ¡x. 300kB por imagem","error-message":t(o).errors.images},null,8,["modelValue","error-message"])]),_:1},8,["form","endpoint","method"])}}});export{T as _};
